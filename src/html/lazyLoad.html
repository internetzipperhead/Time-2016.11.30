<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>懒加载图片</title>
    <link rel="stylesheet" href="../lib/bootstrap/css/bootstrap.css">
</head>
<body>
    <!--<div class="container">
    <div class="col-md-6">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h5 class="panle-title">
                    我就是爱音乐，别叫我停下来
                    <span class="glyphicon glyphicon-yen pull-right"></span>
                </h5>
            </div>
            <div class="panel-body panel-one">
                听海的声音
                <span>我就是火</span>
                <p>
                    slice(start,end)方法的使用
                    <a href="#">String</a>
                </p>
                <address class="location">
                    家住哪里呀，什么工作呀，年薪多少哎呦
                    <br/>
                    Written by <a href="mailto:webmaster@example.com">Donald Duck</a>.<br>
                    Visit us at:<br>
                    Example.com<br>
                    Box 564, Disneyland<br>
                    USA
                </address>
            </div>
        </div>
        <div class="panel panel-warning">
            <div class="panel-heading">
                <h5 class="panel-title">
                    把所有的春天 都揉进了一个清晨
                    <i class="glyphicon glyphicon-apple"></i>
                </h5>
            </div>
            <div class="panel-body envelope-warp">
                <h3 >你是我的唯一<i class="glyphicon glyphicon-heart-empty"></i></h3>
                <p>
                    好想给你写封信。<a class="btn btn-default btn-sm right-single">右边单体</a>
                    &nbsp;
                    告诉你这里的天气。<a class="btn btn-success btn-sm right-clear">没有雾霾</a>
                </p>
                <p>
                    昨夜的那一场电影。<a class="btn btn-default btn-sm envelope-show">信封</a>
                    &nbsp;
                    还有我的心情。<a class="btn btn-success btn-sm envelope-hide"><i class="glyphicon glyphicon-envelope"></i>文字</a>
                </p>
                <ul class="input-demo">
                    <li class="list1">我已经不能肯定：</li>
                    <li class="list2">你是不是还会关心：</li>
                    <li class="list3">或许你不相信：</li>
                </ul>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="panel panel-success">
            <div class="panel-heading">
                <h4 class="panel-title">
                    总有一些歌，唱的都是你
                    <span class="glyphicon glyphicon-chevron-down pull-right"></span>
                </h4>
            </div>
            <div class="panel-body panel-collapse panel-two">
                孤独的心，诠释诗和远方
                <a href="#" class="phone">
                    <i class="glyphicon glyphicon-phone"></i>
                </a>
                <div class="song">
                    <span class="glyphicon glyphicon-heart-empty"></span>
                    我在二环的里面 想着你<br>
                    你在远方的山上 春风十里
                    今天的风吹向你 下了雨
                    我说<br>
                    所有的酒，都不如你
                    <span class="glyphicon glyphicon-heart pull-right"></span>
                    <p>
                        <a class="btn btn-danger tantan">鼓楼夜色</a>
                        <a class="btn btn-danger guan">车水马龙</a>
                    </p>
                    <p>
                        <a class="btn btn-warning">千里之外不离开</a>
                    </p>
                </div>
            </div>
        </div>
        <div class="panel panel-success">
            <div class="panel-heading">
                <h3 class="panel-title">学习面向对象编程</h3>
            </div>
            <div class="panel-body oop">
                <ul>
                    <li id="1">涛哥：</li>
                    <li id="2">延鹏：</li>
                    <li id="3">郜林：</li>
                </ul>
            </div>
        </div>
        <div class="panel panel-success">
            <div class="panel-heading">
                <h3 class="panel-title">学习面向对象编程&#45;&#45;继承父类</h3>
            </div>
            <div class="panel-body inherit">
                <ul>
                    <li id="4">
                        <h4>我在二环路的里面 想着你</h4>
                        <div></div>
                    </li>
                    <li id="5">
                        <h4>你在远方的山上 春风十里</h4>
                        <div></div>
                    </li>
                    <li id="6">
                        <h4>对面的风吹向你 下了雨</h4>
                        <div></div>
                    </li>
                    &lt;!&ndash;tif格式的图片img便签不能显示&ndash;&gt;
                    <img src="../image/trumpet.tif" alt="喇叭"/>
                </ul>
            </div>
        </div>
    </div>
    <div class="col-md-6">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h5 class="panle-title">
                        我就是爱音乐，别叫我停下来
                        <span class="glyphicon glyphicon-yen pull-right"></span>
                    </h5>
                </div>
                <div class="panel-body panel-one">
                    听海的声音
                    <span>我就是火</span>
                    <p>
                        slice(start,end)方法的使用
                        <a href="#">String</a>
                    </p>
                    <address class="location">
                        家住哪里呀，什么工作呀，年薪多少哎呦
                        <br/>
                        Written by <a href="mailto:webmaster@example.com">Donald Duck</a>.<br>
                        Visit us at:<br>
                        Example.com<br>
                        Box 564, Disneyland<br>
                        USA
                    </address>
                </div>
            </div>
            <div class="panel panel-warning">
                <div class="panel-heading">
                    <h5 class="panel-title">
                        把所有的春天 都揉进了一个清晨
                        <i class="glyphicon glyphicon-apple"></i>
                    </h5>
                </div>
                <div class="panel-body envelope-warp">
                    <h3 >你是我的唯一<i class="glyphicon glyphicon-heart-empty"></i></h3>
                    <p>
                        好想给你写封信。<a class="btn btn-default btn-sm right-single">右边单体</a>
                        &nbsp;
                        告诉你这里的天气。<a class="btn btn-success btn-sm right-clear">没有雾霾</a>
                    </p>
                    <p>
                        昨夜的那一场电影。<a class="btn btn-default btn-sm envelope-show">信封</a>
                        &nbsp;
                        还有我的心情。<a class="btn btn-success btn-sm envelope-hide"><i class="glyphicon glyphicon-envelope"></i>文字</a>
                    </p>
                    <ul class="input-demo">
                        <li class="list1">我已经不能肯定：</li>
                        <li class="list2">你是不是还会关心：</li>
                        <li class="list3">或许你不相信：</li>
                    </ul>
                </div>
            </div>
    </div>
    </div>-->
    <div class="container">
        <img data-src="../image/item1.jpg" alt=""/>
        <img data-src="../image/item2.jpg" alt=""/>
        <img data-src="../image/item3.jpg" alt=""/>
        <img data-src="../image/item4.jpg" alt=""/>
        <img data-src="../image/item5.jpg" alt=""/>
        <img data-src="../image/item6.jpg" alt=""/>
        <img data-src="../image/bg_xkn.jpg" alt=""/>
        <img data-src="../image/bg_xav.jpg" alt=""/>
        <img data-src="../image/bg_xnet.jpg" alt=""/>
        <img data-src="../image/bg_member.jpg" alt=""/>
        <img data-src="../image/bg_shoulei.jpg" alt=""/>
    </div>


    <script>
        /**
         * 根据滚动条高度加屏幕高度来判断是否加载这张图片，需要懒加载的图片这样写
         * @param top
         * @constructor
         */
        function SetImg(top){
            var imgs = Array.prototype.slice.apply(document.getElementsByTagName("img"));
            this.imgs = imgs.filter(function(item,index){
                return item.dataset.src;
            });
            this.top = top || 150;
        }
        SetImg.prototype = {
            init:function(){
                this.event();
            },
            setSrc:function(){
                if(this.imgs.length === 0){
                    window.removeEventListener("scroll",this.setSrc);
                }
                var that = this;
                this.imgs.forEach(function(item,index){
                   if(document.documentElement.clientHeight + document.body.scrollTop + that.top > item.offsetTop
                           || item.offsetTop < document.documentElement.clientHeight){
                       console.log(item.offsetTop);
                       item.src = item.dataset.src;
                       that.imgs.splice(index,1);
                   }
                });
            },
            event:function(){
                this.setSrc = this.setSrc.bind(this);
                window.addEventListener("load",this.setSrc);
                window.addEventListener("scroll",this.setSrc);
            }
        };
        new SetImg().init();
    </script>
</body>
</html>